# **Pipeline for Genes Under Positive Selection**

This repository contains a pipeline designed to explore genes under positive selection using the PAML (Phylogenetic Analysis by Maximum Likelihood) software in the context of desert-adapted rodents versus non-desert-adapted rodents. The pipeline utilizes a set of five species:

- Dipodomys spectabilis
- Mus musculus
- Peromyscus eremicus
- Peromyscus maniculatus
- Peromyscus crinitus
- Neotoma lepida
- Onychomys torridus

## **Purpose**
The main purpose of this project is to identify genes that have undergone positive selection in desert-adapted rodent species as compared to their non-desert-adapted counterparts. Positive selection often indicates that specific genes have experienced strong evolutionary pressures, potentially linked to adaptation to arid environments.

Additional information on how to this pipeline is run is presented in the [master pipeline script](Scripts/runpaml.sh).

## **Pipeline Overview**
### **Required Programs**
The following programs must be installed before running the pipeline:

- TranslatorX: Used for aligning nucleotide sequences.
- MAFFT: Employed for sequence alignment.
- pal2nal: Utilized to convert amino acid alignments to codon alignments.
- PAML (Phylogenetic Analysis by Maximum Likelihood): Used for detecting positive selection in genes.

## **Custom Scripts for PAML Pipeline**
In addition to the core PAML pipeline, I've developed a set of custom scripts to streamline and enhance the process of preparing and analyzing data. These scripts have been designed to simplify data management and facilitate the execution of the pipeline. Below is a summary of the custom scripts I've created:

### cds_rename.py
This script serves as a preprocessing step, addressing the complexity of working with header names in the cds_from_genomic.fna file downloaded from NCBI. It renames the headers in the file to more manageable and descriptive names, aiding readability and organization.

### gene_cat.py
The gene_cat.py script automates the extraction of user-specified genes from each species' genome files. It searches through all genome files, extracts the same gene from each species, and outputs the gene sequences into a new file in FASTA format. This process simplifies the collection and aggregation of the genes of interest.

### one_line.py
To further optimize the gene sequences for downstream analysis, the one_line.py script transforms the newly created FASTA file. It converts the format of the file to ensure that each gene sequence line from each species is on its own line. The resulting FASTA file is structured with gene headers followed by sequences, repeated for each species.

### gap_remove.py
The custom gap_remove.py script I've developed addresses alignment issues by removing gaps from the aligned FASTA file generated by MAFFT. This step aims to enhance the accuracy and reliability of subsequent analyses by eliminating gaps that can potentially affect calculations and interpretations.
